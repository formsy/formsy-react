{"version":3,"file":"formsy-react.cjs.development.js","sources":["../src/utils.ts","../src/validationRules.ts","../src/FormsyContext.ts","../src/withFormsy.ts","../src/Formsy.ts"],"sourcesContent":["import { isPlainObject } from 'lodash';\n\nimport { ValidationError, Validations, Values } from './interfaces';\n\nexport function isArray(value: unknown): value is unknown[] {\n  return Array.isArray(value);\n}\n\nexport function isObject(value: unknown): value is object {\n  return isPlainObject(value);\n}\n\nexport function isTypeUndefined(value: unknown): value is undefined {\n  return typeof value === 'undefined';\n}\n\nexport function isDate(value: unknown): value is Date {\n  return value instanceof Date;\n}\n\nexport function isFunction(value: unknown): value is Function {\n  return value !== null && typeof value === 'function';\n}\n\nexport function isString(value: unknown): value is string {\n  return typeof value === 'string';\n}\n\nexport function isNumber(value: unknown): value is number {\n  return typeof value === 'number';\n}\n\nexport function isRegex(value: unknown): value is RegExp {\n  return value instanceof RegExp;\n}\n\nexport function isValueStringEmpty(value: string): boolean {\n  return value === '';\n}\n\nexport function isValueNullOrUndefined(value: unknown): boolean {\n  return value === null || value === undefined;\n}\n\nexport function isValueUndefined(value: unknown): boolean {\n  return value === undefined;\n}\n\nexport function noop() {\n  // do nothing.\n}\n\nexport function protectAgainstParamReassignment(value: unknown) {\n  // Clone objects to avoid accidental param reassignment\n  if (isObject(value)) return { ...value };\n  if (isArray(value)) return [...value];\n  return value;\n}\n\nexport function isSame(a: unknown, b: unknown) {\n  if (typeof a !== typeof b) {\n    return false;\n  }\n\n  if (isArray(a) && isArray(b)) {\n    if (a.length !== b.length) {\n      return false;\n    }\n\n    return a.every((item, index) => isSame(item, b[index]));\n  }\n\n  if (isFunction(a) && isFunction(b)) {\n    return a.toString() === b.toString();\n  }\n\n  if (isDate(a) && isDate(b)) {\n    return a.toString() === b.toString();\n  }\n\n  if (isObject(a) && isObject(b)) {\n    if (Object.keys(a).length !== Object.keys(b).length) {\n      return false;\n    }\n\n    return Object.keys(a).every((key) => isSame(a[key], b[key]));\n  }\n\n  if (isRegex(a) && isRegex(b)) {\n    return a.toString() === b.toString();\n  }\n\n  return a === b;\n}\n\ninterface RulesResult {\n  errors: ValidationError[];\n  failed: string[];\n  success: string[];\n}\n\nexport function runRules<V>(\n  value: V,\n  currentValues: Values,\n  validations: Validations<V>,\n  validationRules: Validations<V>,\n) {\n  const results: RulesResult = {\n    errors: [],\n    failed: [],\n    success: [],\n  };\n\n  Object.keys(validations).forEach((validationName) => {\n    const validationsVal = validations[validationName];\n    const validationRulesVal = validationRules[validationName];\n    const addToResults = (validation) => {\n      if (isString(validation)) {\n        results.errors.push(validation);\n        results.failed.push(validationName);\n      } else if (!validation) {\n        results.failed.push(validationName);\n      } else {\n        results.success.push(validationName);\n      }\n    };\n\n    if (validationRulesVal && isFunction(validationsVal)) {\n      throw new Error(`Formsy does not allow you to override default validations: ${validationName}`);\n    }\n\n    if (!validationRulesVal && !isFunction(validationsVal)) {\n      throw new Error(`Formsy does not have the validation rule: ${validationName}`);\n    }\n\n    if (isFunction(validationsVal)) {\n      return addToResults(validationsVal(currentValues, value));\n    }\n\n    return addToResults(validationRulesVal(currentValues, value, validationsVal));\n  });\n\n  return results;\n}\n\nexport function debounce(callback, timeout: number) {\n  let timer;\n  return (...args) => {\n    clearTimeout(timer);\n    timer = setTimeout(() => {\n      callback.apply(this, args);\n    }, timeout);\n  };\n}\n","import { ValidationFunction, Values } from './interfaces';\nimport {\n  isNumber,\n  isString,\n  isTypeUndefined,\n  isValueNullOrUndefined,\n  isValueStringEmpty,\n  isValueUndefined,\n} from './utils';\n\nexport function isExisty<V>(value: V) {\n  return !isValueNullOrUndefined(value);\n}\n\nexport function isEmpty<V>(value: V) {\n  if (isString(value)) {\n    return isValueStringEmpty(value);\n  }\n  if (isTypeUndefined(value)) {\n    return false;\n  }\n  return isValueUndefined(value);\n}\n\nexport function isDefaultRequiredValue(value: unknown) {\n  return isString(value) ? isValueStringEmpty(value) : isValueNullOrUndefined(value);\n}\n\nexport function matchRegexp<V>(_values: Values, value: V, regexp: RegExp) {\n  return !isExisty(value) || isEmpty(value) || regexp.test(`${value}`);\n}\n\ninterface Validations<V> {\n  [key: string]: ValidationFunction<V>;\n}\n\nconst REGEX_PATTERNS = {\n  ALPHA: /^[A-Z]+$/i,\n  ALPHANUMERIC: /^[0-9A-Z]+$/i,\n  EMAIL:\n    /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/i, // from http://emailregex.com/\n  FLOAT: /^(?:[-+]?(?:\\d+))?(?:\\.\\d*)?(?:[eE][+-]?(?:\\d+))?$/,\n  INT: /^(?:[-+]?(?:0|[1-9]\\d*))$/,\n  NUMERIC: /^[-+]?(?:\\d*[.])?\\d+$/,\n  SPECIAL_WORDS: /^[\\sA-ZÀ-ÖØ-öø-ÿ]+$/i,\n  URL: /^(?:\\w+:)?\\/\\/([^\\s.]+\\.\\S{2}|localhost[:?\\d]*)\\S*$/i,\n  WORDS: /^[A-Z\\s]+$/i,\n};\n\nconst validations: Validations<any> = {\n  equals: <V>(_values, value: V, eql: V) => !isExisty(value) || isEmpty(value) || value === eql,\n  equalsField: <V>(values, value: V, field: string) => value === values[field],\n  isAlpha: <V>(values, value: V) => matchRegexp(values, value, REGEX_PATTERNS.ALPHA),\n  isAlphanumeric: <V>(values, value: V) => matchRegexp(values, value, REGEX_PATTERNS.ALPHANUMERIC),\n  isDefaultRequiredValue: <V>(_values, value: V) => isDefaultRequiredValue(value),\n  isEmail: (values, value: string) => matchRegexp(values, value, REGEX_PATTERNS.EMAIL),\n  isEmptyString: (_values, value: string) => isEmpty(value),\n  isExisty: <V>(_values, value: V) => isExisty(value),\n  isFalse: (_values, value: boolean | string) => value === false,\n  isFloat: <V>(values, value: V) => matchRegexp(values, value, REGEX_PATTERNS.FLOAT),\n  isInt: <V>(values, value: V) => matchRegexp(values, value, REGEX_PATTERNS.INT),\n  isLength: (_values, value: string, length: number) => !isExisty(value) || isEmpty(value) || value.length === length,\n  isNumeric: <V>(values, value: V) => isNumber(value) || matchRegexp(values, value, REGEX_PATTERNS.NUMERIC),\n  isSpecialWords: <V>(values, value: V) => matchRegexp(values, value, REGEX_PATTERNS.SPECIAL_WORDS),\n  isTrue: (_values, value: boolean | string) => value === true,\n  isUndefined: <V>(_values, value: V) => isValueUndefined(value),\n  isUrl: <V>(values, value: V) => matchRegexp(values, value, REGEX_PATTERNS.URL),\n  isWords: <V>(values, value: V) => matchRegexp(values, value, REGEX_PATTERNS.WORDS),\n  matchRegexp,\n  maxLength: (_values, value: string, length: number) => !isExisty(value) || value.length <= length,\n  minLength: (_values, value: string, length: number) => !isExisty(value) || isEmpty(value) || value.length >= length,\n};\n\nexport const addValidationRule = <V>(name: string, func: ValidationFunction<V>) => {\n  validations[name] = func;\n};\n\nexport default validations;\n","import React from 'react';\nimport { FormsyContextInterface } from './interfaces';\n\nconst noFormsyErrorMessage = 'Could not find Formsy Context Provider. Did you use withFormsy outside <Formsy />?';\n\nconst throwNoFormsyProvider = () => {\n  // istanbul ignore next\n  throw new Error(noFormsyErrorMessage);\n};\n\nconst defaultValue = {\n  attachToForm: throwNoFormsyProvider,\n  detachFromForm: throwNoFormsyProvider,\n  isFormDisabled: true,\n  isValidValue: throwNoFormsyProvider,\n  validate: throwNoFormsyProvider,\n  runValidation: throwNoFormsyProvider,\n};\n\nexport default React.createContext<FormsyContextInterface>(defaultValue);\n","import PropTypes from 'prop-types';\nimport React from 'react';\nimport FormsyContext from './FormsyContext';\nimport {\n  ComponentWithStaticAttributes,\n  FormsyContextInterface,\n  RequiredValidation,\n  ValidationError,\n  Validations,\n  WrappedComponentClass,\n} from './interfaces';\n\nimport * as utils from './utils';\nimport { isString } from './utils';\nimport { isDefaultRequiredValue } from './validationRules';\n\n/* eslint-disable react/default-props-match-prop-types */\n\nconst convertValidationsToObject = <V>(validations: false | Validations<V>): Validations<V> => {\n  if (isString(validations)) {\n    return validations.split(/,(?![^{[]*[}\\]])/g).reduce((validationsAccumulator, validation) => {\n      let args: string[] = validation.split(':');\n      const validateMethod: string = args.shift();\n\n      args = args.map((arg) => {\n        try {\n          return JSON.parse(arg);\n        } catch (e) {\n          return arg; // It is a string if it can not parse it\n        }\n      });\n\n      if (args.length > 1) {\n        throw new Error(\n          'Formsy does not support multiple args on string validations. Use object format of validations instead.',\n        );\n      }\n\n      // Avoid parameter reassignment\n      const validationsAccumulatorCopy: Validations<V> = { ...validationsAccumulator };\n      validationsAccumulatorCopy[validateMethod] = args.length ? args[0] : true;\n      return validationsAccumulatorCopy;\n    }, {});\n  }\n\n  return validations || {};\n};\n\nexport const propTypes = {\n  innerRef: PropTypes.func,\n  name: PropTypes.string.isRequired,\n  required: PropTypes.oneOfType([PropTypes.bool, PropTypes.object, PropTypes.string]),\n  validations: PropTypes.oneOfType([PropTypes.object, PropTypes.string]),\n  value: PropTypes.any, // eslint-disable-line react/forbid-prop-types\n};\n\nexport interface WrapperProps<V> {\n  innerRef?: (ref: React.Ref<any>) => void;\n  name: string;\n  required?: RequiredValidation<V>;\n  validationError?: ValidationError;\n  validationErrors?: { [key: string]: ValidationError };\n  validations?: Validations<V>;\n  value?: V;\n}\n\nexport interface WrapperState<V> {\n  [key: string]: unknown;\n\n  formSubmitted: boolean;\n  isPristine: boolean;\n  isRequired: boolean;\n  isValid: boolean;\n  pristineValue: V;\n  validationError: ValidationError[];\n  value: V;\n}\n\nexport interface InjectedProps<V> {\n  errorMessage: ValidationError;\n  errorMessages: ValidationError[];\n  hasValue: boolean;\n  isFormDisabled: boolean;\n  isFormSubmitted: boolean;\n  isPristine: boolean;\n  isRequired: boolean;\n  isValid: boolean;\n  isValidValue: (value: V) => boolean;\n  ref?: React.Ref<any>;\n  resetValue: () => void;\n  setValidations: (validations: Validations<V>, required: RequiredValidation<V>) => void;\n  setValue: (value: V, validate?: boolean) => void;\n  showError: boolean;\n  showRequired: boolean;\n}\n\nexport interface WrapperInstanceMethods<V> {\n  getErrorMessage: () => null | ValidationError;\n  getErrorMessages: () => ValidationError[];\n  getValue: () => V;\n  isFormDisabled: () => boolean;\n  isFormSubmitted: () => boolean;\n  isValid: () => boolean;\n  isValidValue: (value: V) => boolean;\n  setValue: (value: V, validate?: boolean) => void;\n}\n\nexport type PassDownProps<V> = WrapperProps<V> & InjectedProps<V>;\n\nfunction getDisplayName(component: WrappedComponentClass) {\n  return component.displayName || component.name || (utils.isString(component) ? component : 'Component');\n}\n\nexport default function withFormsy<T, V>(\n  WrappedComponent: React.ComponentType<T & PassDownProps<V>>,\n): React.ComponentType<Omit<T & WrapperProps<V>, keyof InjectedProps<V>>> {\n  class WithFormsyWrapper\n    extends React.Component<T & WrapperProps<V> & FormsyContextInterface, WrapperState<V>>\n    implements WrapperInstanceMethods<V>\n  {\n    public validations?: Validations<V>;\n\n    public requiredValidations?: Validations<V>;\n\n    public static displayName = `Formsy(${getDisplayName(WrappedComponent)})`;\n\n    public static propTypes: any = propTypes;\n\n    public static defaultProps: any = {\n      innerRef: null,\n      required: false,\n      validationError: '',\n      validationErrors: {},\n      validations: null,\n      value: (WrappedComponent as ComponentWithStaticAttributes).defaultValue,\n    };\n\n    public constructor(props) {\n      super(props);\n      const { runValidation, validations, required, value } = props;\n\n      this.state = { value } as any;\n\n      this.setValidations(validations, required);\n\n      this.state = {\n        formSubmitted: false,\n        isPristine: true,\n        pristineValue: props.value,\n        value: props.value,\n        ...runValidation(this, props.value),\n      };\n    }\n\n    public componentDidMount() {\n      const { name, attachToForm } = this.props;\n\n      if (!name) {\n        throw new Error('Form Input requires a name property when used');\n      }\n\n      attachToForm(this);\n    }\n\n    public shouldComponentUpdate(nextProps, nextState) {\n      const { props, state } = this;\n      const isChanged = (a: object, b: object): boolean => Object.keys(a).some((k) => a[k] !== b[k]);\n      const isPropsChanged = isChanged(props, nextProps);\n      const isStateChanged = isChanged(state, nextState);\n\n      return isPropsChanged || isStateChanged;\n    }\n\n    public componentDidUpdate(prevProps) {\n      const { value, validations, required, validate } = this.props;\n\n      // If the value passed has changed, set it. If value is not passed it will\n      // internally update, and this will never run\n      if (!utils.isSame(value, prevProps.value)) {\n        this.setValue(value);\n      }\n\n      // If validations or required is changed, run a new validation\n      if (!utils.isSame(validations, prevProps.validations) || !utils.isSame(required, prevProps.required)) {\n        this.setValidations(validations, required);\n        validate(this);\n      }\n    }\n\n    // Detach it when component unmounts\n    public componentWillUnmount() {\n      const { detachFromForm } = this.props;\n      detachFromForm(this);\n    }\n\n    public getErrorMessage = (): ValidationError | null => {\n      const messages = this.getErrorMessages();\n      return messages.length ? messages[0] : null;\n    };\n\n    public getErrorMessages = (): ValidationError[] => {\n      const { validationError } = this.state;\n\n      if (!this.isValid() || this.showRequired()) {\n        return validationError || [];\n      }\n      return [];\n    };\n\n    // eslint-disable-next-line react/destructuring-assignment\n    public getValue = (): V => this.state.value;\n\n    public setValidations = (validations: Validations<V>, required: RequiredValidation<V>): void => {\n      // Add validations to the store itself as the props object can not be modified\n      this.validations = convertValidationsToObject(validations) || {};\n      this.requiredValidations =\n        required === true ? { isDefaultRequiredValue: required } : convertValidationsToObject(required);\n    };\n\n    // By default, we validate after the value has been set.\n    // A user can override this and pass a second parameter of `false` to skip validation.\n    public setValue = (value: V, validate = true): void => {\n      const { validate: validateForm } = this.props;\n\n      if (!validate) {\n        this.setState({ value });\n      } else {\n        this.setState(\n          {\n            value,\n            isPristine: false,\n          },\n          () => {\n            validateForm(this);\n          },\n        );\n      }\n    };\n\n    // eslint-disable-next-line react/destructuring-assignment\n    public hasValue = () => {\n      const { value } = this.state;\n      return isDefaultRequiredValue(value);\n    };\n\n    // eslint-disable-next-line react/destructuring-assignment\n    public isFormDisabled = (): boolean => this.props.isFormDisabled;\n\n    // eslint-disable-next-line react/destructuring-assignment\n    public isFormSubmitted = (): boolean => this.state.formSubmitted;\n\n    // eslint-disable-next-line react/destructuring-assignment\n    public isPristine = (): boolean => this.state.isPristine;\n\n    // eslint-disable-next-line react/destructuring-assignment\n    public isRequired = (): boolean => !!this.props.required;\n\n    // eslint-disable-next-line react/destructuring-assignment\n    public isValid = (): boolean => this.state.isValid;\n\n    // eslint-disable-next-line react/destructuring-assignment\n    public isValidValue = (value: V) => this.props.isValidValue(this, value);\n\n    public resetValue = () => {\n      const { pristineValue } = this.state;\n      const { validate } = this.props;\n\n      this.setState(\n        {\n          value: pristineValue,\n          isPristine: true,\n        },\n        () => {\n          validate(this);\n        },\n      );\n    };\n\n    public showError = (): boolean => !this.showRequired() && !this.isValid();\n\n    // eslint-disable-next-line react/destructuring-assignment\n    public showRequired = (): boolean => this.state.isRequired;\n\n    public render() {\n      const { innerRef } = this.props;\n      const propsForElement: T & PassDownProps<V> = {\n        ...this.props,\n        errorMessage: this.getErrorMessage(),\n        errorMessages: this.getErrorMessages(),\n        hasValue: this.hasValue(),\n        isFormDisabled: this.isFormDisabled(),\n        isFormSubmitted: this.isFormSubmitted(),\n        isPristine: this.isPristine(),\n        isRequired: this.isRequired(),\n        isValid: this.isValid(),\n        isValidValue: this.isValidValue,\n        resetValue: this.resetValue,\n        setValidations: this.setValidations,\n        setValue: this.setValue,\n        showError: this.showError(),\n        showRequired: this.showRequired(),\n        value: this.getValue(),\n      };\n\n      if (innerRef) {\n        propsForElement.ref = innerRef;\n      }\n\n      return React.createElement(WrappedComponent, propsForElement);\n    }\n  }\n\n  // eslint-disable-next-line react/display-name\n  return (props) =>\n    React.createElement(FormsyContext.Consumer, null, ((contextValue) => {\n      return React.createElement(WithFormsyWrapper, { ...props, ...contextValue });\n    }) as any);\n}\n","/* eslint-disable react/no-unused-state, react/default-props-match-prop-types */\nimport { get, has, set } from 'lodash';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport FormsyContext from './FormsyContext';\nimport {\n  FormsyContextInterface,\n  IModel,\n  InputComponent,\n  IResetModel,\n  IUpdateInputsWithError,\n  IUpdateInputsWithValue,\n  ValidationError,\n} from './interfaces';\nimport { debounce, isObject, isString } from './utils';\nimport * as utils from './utils';\nimport validationRules from './validationRules';\nimport { PassDownProps } from './withFormsy';\n\ntype FormHTMLAttributesCleaned = Omit<React.FormHTMLAttributes<HTMLFormElement>, 'onChange' | 'onSubmit'>;\n\ntype OnSubmitCallback = (\n  model: IModel,\n  resetModel: IResetModel,\n  updateInputsWithError: IUpdateInputsWithError,\n  event: React.SyntheticEvent<HTMLFormElement>,\n) => void;\n\ntype FormElementType =\n  | string\n  | React.ComponentType<{\n      onReset?: (e: React.SyntheticEvent) => void;\n      onSubmit?: (e: React.SyntheticEvent) => void;\n      disabled?: boolean;\n      children?: React.ReactChildren;\n    }>;\n\nexport interface FormsyProps extends FormHTMLAttributesCleaned {\n  disabled: boolean;\n  mapping: null | ((model: IModel) => IModel);\n  onChange: (model: IModel, isChanged: boolean) => void;\n  onInvalid: () => void;\n  onReset?: () => void;\n  onSubmit?: OnSubmitCallback;\n  onValidSubmit?: OnSubmitCallback;\n  onInvalidSubmit: OnSubmitCallback;\n  onValid: () => void;\n  preventDefaultSubmit?: boolean;\n  preventExternalInvalidation?: boolean;\n  validationErrors?: null | object;\n  formElement?: FormElementType;\n}\n\nexport interface FormsyState {\n  canChange: boolean;\n  contextValue: FormsyContextInterface;\n  formSubmitted?: boolean;\n  isPristine?: boolean;\n  isSubmitting: boolean;\n  isValid: boolean;\n}\n\nconst ONE_RENDER_FRAME = 66;\n\nexport class Formsy extends React.Component<FormsyProps, FormsyState> {\n  public inputs: InstanceType<any & PassDownProps<any>>[];\n\n  public emptyArray: any[];\n\n  public prevInputNames: any[] | null = null;\n\n  public static displayName = 'Formsy';\n\n  public static propTypes = {\n    disabled: PropTypes.bool,\n    mapping: PropTypes.func,\n    formElement: PropTypes.oneOfType([PropTypes.string, PropTypes.object, PropTypes.func]),\n    onChange: PropTypes.func,\n    onInvalid: PropTypes.func,\n    onInvalidSubmit: PropTypes.func,\n    onReset: PropTypes.func,\n    onSubmit: PropTypes.func,\n    onValid: PropTypes.func,\n    onValidSubmit: PropTypes.func,\n    preventDefaultSubmit: PropTypes.bool,\n    preventExternalInvalidation: PropTypes.bool,\n    validationErrors: PropTypes.object, // eslint-disable-line\n  };\n\n  public static defaultProps: Partial<FormsyProps> = {\n    disabled: false,\n    mapping: null,\n    onChange: utils.noop,\n    onInvalid: utils.noop,\n    onInvalidSubmit: utils.noop,\n    onReset: utils.noop,\n    onSubmit: utils.noop,\n    onValid: utils.noop,\n    onValidSubmit: utils.noop,\n    preventDefaultSubmit: true,\n    preventExternalInvalidation: false,\n    validationErrors: {},\n    formElement: 'form',\n  };\n\n  private readonly debouncedValidateForm: () => void;\n\n  public constructor(props: FormsyProps) {\n    super(props);\n    this.state = {\n      canChange: false,\n      isSubmitting: false,\n      isValid: true,\n      contextValue: {\n        attachToForm: this.attachToForm,\n        detachFromForm: this.detachFromForm,\n        isFormDisabled: props.disabled,\n        isValidValue: this.isValidValue,\n        validate: this.validate,\n        runValidation: this.runValidation,\n      },\n    };\n    this.inputs = [];\n    this.emptyArray = [];\n    this.debouncedValidateForm = debounce(this.validateForm, ONE_RENDER_FRAME);\n  }\n\n  public componentDidMount = () => {\n    this.prevInputNames = this.inputs.map((component) => component.props.name);\n    this.validateForm();\n  };\n\n  public componentDidUpdate = (prevProps: FormsyProps) => {\n    const { validationErrors, disabled } = this.props;\n\n    if (validationErrors && isObject(validationErrors) && Object.keys(validationErrors).length > 0) {\n      this.setInputValidationErrors(validationErrors);\n    }\n\n    const newInputNames = this.inputs.map((component) => component.props.name);\n    if (this.prevInputNames && !utils.isSame(this.prevInputNames, newInputNames)) {\n      this.prevInputNames = newInputNames;\n      this.validateForm();\n    }\n\n    // Keep the disabled value in state/context the same as from props\n    if (disabled !== prevProps.disabled) {\n      // eslint-disable-next-line\n      this.setState((state) => ({\n        ...state,\n        contextValue: {\n          ...state.contextValue,\n          isFormDisabled: disabled,\n        },\n      }));\n    }\n  };\n\n  public getCurrentValues = () =>\n    this.inputs.reduce((valueAccumulator, component) => {\n      const {\n        props: { name },\n        state: { value },\n      } = component;\n      // eslint-disable-next-line no-param-reassign\n      valueAccumulator[name] = utils.protectAgainstParamReassignment(value);\n      return valueAccumulator;\n    }, {});\n\n  public getModel = () => {\n    const currentValues = this.getCurrentValues();\n    return this.mapModel(currentValues);\n  };\n\n  public getPristineValues = () =>\n    this.inputs.reduce((valueAccumulator, component) => {\n      const {\n        props: { name, value },\n      } = component;\n      // eslint-disable-next-line no-param-reassign\n      valueAccumulator[name] = utils.protectAgainstParamReassignment(value);\n      return valueAccumulator;\n    }, {});\n\n  public setFormPristine = (isPristine: boolean) => {\n    this.setState({\n      formSubmitted: !isPristine,\n    });\n\n    // Iterate through each component and set it as pristine\n    // or \"dirty\".\n    this.inputs.forEach((component) => {\n      component.setState({\n        formSubmitted: !isPristine,\n        isPristine,\n      });\n    });\n  };\n\n  public setInputValidationErrors = (errors) => {\n    const { preventExternalInvalidation } = this.props;\n    const { isValid } = this.state;\n\n    this.inputs.forEach((component) => {\n      const { name } = component.props;\n      component.setState({\n        isValid: !(name in errors),\n        validationError: isString(errors[name]) ? [errors[name]] : errors[name],\n      });\n    });\n    if (!preventExternalInvalidation && isValid) {\n      this.setFormValidState(false);\n    }\n  };\n\n  public setFormValidState = (allIsValid: boolean) => {\n    const { onValid, onInvalid } = this.props;\n\n    this.setState({\n      isValid: allIsValid,\n    });\n\n    if (allIsValid) {\n      onValid();\n    } else {\n      onInvalid();\n    }\n  };\n\n  public isValidValue = (component, value) => this.runValidation(component, value).isValid;\n\n  // eslint-disable-next-line react/destructuring-assignment\n  public isFormDisabled = () => this.props.disabled;\n\n  public mapModel = (model: IModel): IModel => {\n    const { mapping } = this.props;\n\n    if (mapping) {\n      return mapping(model);\n    }\n\n    const returnModel = {};\n    Object.keys(model).forEach((key) => {\n      set(returnModel, key, model[key]);\n    });\n    return returnModel;\n  };\n\n  public reset = (model?: IModel) => {\n    this.setFormPristine(true);\n    this.resetModel(model);\n  };\n\n  private resetInternal = (event) => {\n    const { onReset } = this.props;\n\n    event.preventDefault();\n    this.reset();\n    if (onReset) {\n      onReset();\n    }\n  };\n\n  // Reset each key in the model to the original / initial / specified value\n  private resetModel: IResetModel = (data) => {\n    this.inputs.forEach((component) => {\n      const { name } = component.props;\n      if (data && has(data, name)) {\n        component.setValue(get(data, name));\n      } else {\n        component.resetValue();\n      }\n    });\n    this.validateForm();\n  };\n\n  // Checks validation on current value or a passed value\n  public runValidation = <V>(\n    component: InputComponent<V>,\n    value = component.state.value,\n  ): { isRequired: boolean; isValid: boolean; validationError: ValidationError[] } => {\n    const { validationErrors } = this.props;\n    const { validationError, validationErrors: componentValidationErrors, name } = component.props;\n    const currentValues = this.getCurrentValues();\n    const validationResults = utils.runRules(value, currentValues, component.validations, validationRules);\n    const requiredResults = utils.runRules(value, currentValues, component.requiredValidations, validationRules);\n    const isRequired = Object.keys(component.requiredValidations).length ? !!requiredResults.success.length : false;\n    const isValid = !validationResults.failed.length && !(validationErrors && validationErrors[component.props.name]);\n\n    return {\n      isRequired,\n      isValid: isRequired ? false : isValid,\n      validationError: (() => {\n        if (isValid && !isRequired) {\n          return this.emptyArray;\n        }\n\n        if (validationResults.errors.length) {\n          return validationResults.errors;\n        }\n\n        if (validationErrors && validationErrors[name]) {\n          return isString(validationErrors[name]) ? [validationErrors[name]] : validationErrors[name];\n        }\n\n        if (isRequired) {\n          const error = componentValidationErrors[requiredResults.success[0]] || validationError;\n          return error ? [error] : null;\n        }\n\n        if (validationResults.failed.length) {\n          return validationResults.failed\n            .map((failed) => (componentValidationErrors[failed] ? componentValidationErrors[failed] : validationError))\n            .filter((x, pos, arr) => arr.indexOf(x) === pos); // remove duplicates\n        }\n\n        // This line is not reachable\n        // istanbul ignore next\n        return undefined;\n      })(),\n    };\n  };\n\n  // Method put on each input component to register\n  // itself to the form\n  public attachToForm = (component) => {\n    if (this.inputs.indexOf(component) === -1) {\n      this.inputs.push(component);\n    }\n\n    const { onChange } = this.props;\n    const { canChange } = this.state;\n\n    // Trigger onChange\n    if (canChange) {\n      onChange(this.getModel(), this.isChanged());\n    }\n\n    this.debouncedValidateForm();\n  };\n\n  // Method put on each input component to unregister\n  // itself from the form\n  public detachFromForm = <V>(component: InputComponent<V>) => {\n    this.inputs = this.inputs.filter((input) => input !== component);\n\n    this.debouncedValidateForm();\n  };\n\n  // Checks if the values have changed from their initial value\n  public isChanged = () => !utils.isSame(this.getPristineValues(), this.getCurrentValues());\n\n  // Update model, submit to url prop and send the model\n  public submit = (event?: React.SyntheticEvent<HTMLFormElement>) => {\n    const { onSubmit, onValidSubmit, onInvalidSubmit, preventDefaultSubmit } = this.props;\n    const { isValid } = this.state;\n\n    if (preventDefaultSubmit && event && event.preventDefault) {\n      event.preventDefault();\n    }\n\n    // Trigger form as not pristine.\n    // If any inputs have not been touched yet this will make them dirty\n    // so validation becomes visible (if based on isPristine)\n    this.setFormPristine(false);\n    const model = this.getModel();\n    onSubmit(model, this.resetModel, this.updateInputsWithError, event);\n\n    if (isValid) {\n      onValidSubmit(model, this.resetModel, this.updateInputsWithError, event);\n    } else {\n      onInvalidSubmit(model, this.resetModel, this.updateInputsWithError, event);\n    }\n  };\n\n  // Go through errors from server and grab the components\n  // stored in the inputs map. Change their state to invalid\n  // and set the serverError message\n  public updateInputsWithError: IUpdateInputsWithError = (errors, invalidate) => {\n    const { preventExternalInvalidation } = this.props;\n    const { isValid } = this.state;\n\n    Object.entries(errors).forEach(([name, error]) => {\n      const component = this.inputs.find((input) => input.props.name === name);\n      if (!component) {\n        throw new Error(\n          `You are trying to update an input that does not exist. Verify errors object with input names. ${JSON.stringify(\n            errors,\n          )}`,\n        );\n      }\n      component.setState({\n        isValid: preventExternalInvalidation,\n        validationError: utils.isString(error) ? [error] : error,\n      });\n    });\n\n    if (invalidate && isValid) {\n      this.setFormValidState(false);\n    }\n  };\n\n  // Set the value of components\n  public updateInputsWithValue: IUpdateInputsWithValue<any> = (data, validate) => {\n    this.inputs.forEach((component) => {\n      const { name } = component.props;\n      if (data && has(data, name)) {\n        component.setValue(get(data, name), validate);\n      }\n    });\n  };\n\n  // Use the binded values and the actual input value to\n  // validate the input and set its state. Then check the\n  // state of the form itself\n  public validate = <V>(component: InputComponent<V>) => {\n    const { onChange } = this.props;\n    const { canChange } = this.state;\n\n    // Trigger onChange\n    if (canChange) {\n      onChange(this.getModel(), this.isChanged());\n    }\n\n    const validationState = this.runValidation<V>(component);\n    // Run through the validations, split them up and call\n    // the validator IF there is a value or it is required\n    component.setState(validationState, this.validateForm);\n  };\n\n  // Validate the form by going through all child input components\n  // and check their state\n  public validateForm = () => {\n    // We need a callback as we are validating all inputs again. This will\n    // run when the last input has set its state\n    const onValidationComplete = () => {\n      const allIsValid = this.inputs.every((component) => component.state.isValid);\n\n      this.setFormValidState(allIsValid);\n\n      // Tell the form that it can start to trigger change events\n      this.setState({\n        canChange: true,\n      });\n    };\n\n    if (this.inputs.length === 0) {\n      onValidationComplete();\n    } else {\n      // Run validation again in case affected by other inputs. The\n      // last component validated will run the onValidationComplete callback\n      this.inputs.forEach((component, index) => {\n        const validationState = this.runValidation(component);\n        const isLastInput = index === this.inputs.length - 1;\n        const callback = isLastInput ? onValidationComplete : null;\n        component.setState(validationState, callback);\n      });\n    }\n  };\n\n  public render() {\n    const {\n      /* eslint-disable @typescript-eslint/no-unused-vars */\n      children,\n      mapping,\n      onChange,\n      onInvalid,\n      onInvalidSubmit,\n      onReset,\n      onSubmit,\n      onValid,\n      onValidSubmit,\n      preventDefaultSubmit,\n      preventExternalInvalidation,\n      validationErrors,\n      disabled,\n      formElement,\n      ...nonFormsyProps\n    } = this.props;\n    const { contextValue } = this.state;\n\n    return React.createElement(\n      FormsyContext.Provider,\n      {\n        value: contextValue,\n      },\n      React.createElement(\n        formElement,\n        {\n          onReset: this.resetInternal,\n          onSubmit: this.submit,\n          ...nonFormsyProps,\n          disabled,\n        },\n        children,\n      ),\n    );\n  }\n}\n"],"names":["isArray","value","Array","isObject","isPlainObject","isTypeUndefined","isDate","Date","isFunction","isString","isNumber","isRegex","RegExp","isValueStringEmpty","isValueNullOrUndefined","undefined","isValueUndefined","noop","protectAgainstParamReassignment","isSame","a","b","length","every","item","index","toString","Object","keys","key","runRules","currentValues","validations","validationRules","results","errors","failed","success","forEach","validationName","validationsVal","validationRulesVal","addToResults","validation","push","Error","debounce","callback","timeout","timer","args","clearTimeout","setTimeout","apply","isExisty","isEmpty","isDefaultRequiredValue","matchRegexp","_values","regexp","test","REGEX_PATTERNS","ALPHA","ALPHANUMERIC","EMAIL","FLOAT","INT","NUMERIC","SPECIAL_WORDS","URL","WORDS","equals","eql","equalsField","values","field","isAlpha","isAlphanumeric","isEmail","isEmptyString","isFalse","isFloat","isInt","isLength","isNumeric","isSpecialWords","isTrue","isUndefined","isUrl","isWords","maxLength","minLength","addValidationRule","name","func","noFormsyErrorMessage","throwNoFormsyProvider","defaultValue","attachToForm","detachFromForm","isFormDisabled","isValidValue","validate","runValidation","React","createContext","convertValidationsToObject","split","reduce","validationsAccumulator","validateMethod","shift","map","arg","JSON","parse","e","validationsAccumulatorCopy","propTypes","innerRef","PropTypes","string","isRequired","required","oneOfType","bool","object","any","getDisplayName","component","displayName","utils","withFormsy","WrappedComponent","WithFormsyWrapper","props","messages","getErrorMessages","validationError","state","isValid","showRequired","requiredValidations","validateForm","setState","isPristine","formSubmitted","pristineValue","setValidations","componentDidMount","shouldComponentUpdate","nextProps","nextState","isChanged","some","k","isPropsChanged","isStateChanged","componentDidUpdate","prevProps","setValue","componentWillUnmount","render","propsForElement","errorMessage","getErrorMessage","errorMessages","hasValue","isFormSubmitted","resetValue","showError","getValue","ref","createElement","Component","validationErrors","FormsyContext","Consumer","contextValue","ONE_RENDER_FRAME","Formsy","prevInputNames","inputs","disabled","setInputValidationErrors","newInputNames","valueAccumulator","getCurrentValues","mapModel","preventExternalInvalidation","setFormValidState","allIsValid","onValid","onInvalid","model","mapping","returnModel","set","setFormPristine","resetModel","event","onReset","preventDefault","reset","data","has","get","componentValidationErrors","validationResults","requiredResults","emptyArray","error","filter","x","pos","arr","indexOf","onChange","canChange","getModel","debouncedValidateForm","input","getPristineValues","onSubmit","onValidSubmit","onInvalidSubmit","preventDefaultSubmit","updateInputsWithError","invalidate","entries","find","stringify","validationState","onValidationComplete","isLastInput","isSubmitting","children","formElement","nonFormsyProps","Provider","resetInternal","submit"],"mappings":"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"}